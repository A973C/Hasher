/*!
 * Hasher <http://github.com/millermedeiros/hasher>
 * @author Miller Medeiros <http://millermedeiros.com>
 * @version 0.9.92+ (2011/06/18 05:52 PM)
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
var hasher=(function(h){var d,l=h.document,a=h.location,k=h.history,p=signals.Signal,o,j,x,b,e=(!+"\v1"),t=("onhashchange" in h),c=e&&!t,m=(a.protocol==="file:");function n(z){z=z||"";var y=new RegExp("^\\"+d.prependHash+"|\\"+d.appendHash+"$","g");return z.replace(y,"")}function s(){return(b)?b.contentWindow.frameHash:null}function f(z){if(b&&z!=s()){var y=b.contentWindow.document;y.open();y.write("<html><head><title>"+d.getTitle()+'</title><script type="text/javascript">var frameHash="'+z+'";<\/script></head><body>&nbsp;</body></html>');y.close()}}function i(y){y=decodeURIComponent(y);if(o!=y){var z=o;o=y;if(c){f(y)}d.changed.dispatch(n(y),n(z))}}function r(){b=l.createElement("iframe");b.src="about:blank";b.style.display="none";l.body.appendChild(b)}function w(){var y=/#(.*)$/.exec(d.getURL());return(y&&y[1])?decodeURIComponent(y[1]):""}function v(){var y=w();if(y!=o){i(y)}}function g(){var z=w(),y=n(s());if(y!=o&&y!=z){d.setHash(y)}else{if(z!=o){i(z)}}}function u(A,y,z){if(A.addEventListener){A.addEventListener(y,z,false)}else{if(A.attachEvent){A.attachEvent("on"+y,z)}}}function q(A,y,z){if(A.removeEventListener){A.removeEventListener(y,z,false)}else{if(A.detachEvent){A.detachEvent("on"+y,z)}}}d={VERSION:"0.9.92+",appendHash:"",prependHash:"/",separator:"/",changed:new p(),stopped:new p(),initialized:new p(),init:function(){if(x){return}var y=o;o=w();if(t){u(h,"hashchange",v)}else{if(c){if(!b){r();f(o)}j=setInterval(g,25)}else{j=setInterval(v,25)}}x=true;this.initialized.dispatch(n(o),n(y))},stop:function(){if(!x){return}if(t){q(h,"hashchange",v)}else{clearInterval(j);j=null}x=false;this.stopped.dispatch(n(o),n(o))},isActive:function(){return x},getURL:function(){return a.href},getBaseURL:function(){return this.getURL().replace(/(\?.*)|(\#.*)/,"")},setHash:function(y){y=(y)?this.prependHash+y.replace(/^\#/,"")+this.appendHash:y;if(y!=o){i(y);if(e&&m){y=y.replace(/\?/,"%3F")}a.hash="#"+encodeURI(y)}},getHash:function(){return n(o)},getHashAsArray:function(){return this.getHash().split(this.separator)},setTitle:function(y){l.title=y},getTitle:function(){return l.title},back:function(){k.back()},forward:function(){k.forward()},go:function(y){k.go(y)},dispose:function(){d.initialized.removeAll();d.stopped.removeAll();d.changed.removeAll();d.stop();b=d=h.hasher=null},toString:function(){return'[hasher version="'+this.VERSION+'" hash="'+this.getHash()+'"]'}};return d}(window||this));