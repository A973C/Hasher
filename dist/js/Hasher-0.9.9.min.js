/*
 * Hasher <http://github.com/millermedeiros/Hasher>
 * Includes: millermedeiros.EventDispatcher (1.0), millermedeiros.queryUtils (0.8.2), millermedeiros.event-listenerFacade (0.3)
 * @author Miller Medeiros <http://www.millermedeiros.com/>
 * @version 0.9.9 (2010/11/05)
 * Released under the MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
(function(c,b){var a=c.millermedeiros={};a.EventDispatcher=function(){this._handlers={};this._disabled=[]};a.EventDispatcher.prototype={addEventListener:function(d,e){if(typeof this._handlers[d]==="undefined"){this._handlers[d]=[]}this._handlers[d].push(e)},removeEventListener:function(e,f){if(!this.hasEventListener(e)){return}var d=this._handlers[e],g=d.length;if(g==1){delete this._handlers[e]}else{while(g--){if(d[g]==f){d.splice(g,1);break}}}},removeAllEventListeners:function(d){if(typeof d==="string"&&this.hasEventListener(d)){delete this._handlers[d]}else{if(d){this._handlers={}}}},hasEventListener:function(d){return(typeof this._handlers[d]!=="undefined")},dispatchEvent:function(d){d=(typeof d==="string")?{type:d}:d;if(this.hasEventListener(d.type)&&this.isEventEnabled(d.type)){var e=this._handlers[d.type],g,f,h=e.length;d.target=d.target||this;for(f=0;f<h;f++){g=e[f];g(d)}return true}return false},isEventEnabled:function(e){var d=this._disabled.length;while(d--){if(this._disabled[d]===e){return false}}return true},disableEvent:function(f){var e=Array.prototype.slice.call(arguments,0),g=e.length,d;while(g--){d=e[g];if(this.isEventEnabled(d)){this._disabled.push(d)}}},enableEvent:function(g){var f=Array.prototype.slice.call(arguments,0),h=f.length,d,e;while(h--){e=f[h];d=this._disabled.length;while(d--){if(this._disabled[d]===e){this._disabled.splice(d,1);break}}}}};(function(f,d){var e=f.location;d.queryUtils={getQueryString:function(g){g=g||e.href;g=g.replace(/#[\w\W]*/,"");var h=/\?[a-zA-Z0-9\=\&\%\$\-\_\.\+\!\*\'\(\)\,]+/.exec(g);return(h)?decodeURIComponent(h[0]):""},getQueryObject:function(g){return this.toQueryObject(this.getQueryString(g))},toQueryObject:function(k){var g=k.replace("?","").split("&"),j=g.length,i={},h;while(j--){g[j]=g[j].split("=");h=g[j][1];i[g[j][0]]=isNaN(h)?h:parseFloat(h)}return i},getParamValue:function(k,h){h=h||e.href;var j=new RegExp("(\\?|&)"+k+"=([^&]*)"),g=j.exec(h),i=(g&&g[2])?g[2]:null;return isNaN(i)?i:parseFloat(i)},hasParam:function(i,g){var h=new RegExp("(\\?|&)"+i+"=","g");return h.test(this.getQueryString(g))},toQueryString:function(h){var g=[],i;for(i in h){if(h.hasOwnProperty(i)){g.push(i+"="+h[i])}}return(g.length)?"?"+g.join("&"):""}}}(c,a));a.event=a.event||{};a.event.addListener=function(f,d,e){if(f.addEventListener){f.addEventListener(d,e,false)}else{if(f.attachEvent){f.attachEvent("on"+d,e)}else{f["on"+d]=e}}};a.event.removeListener=function(f,d,e){if(f.removeEventListener){f.removeEventListener(d,e,false)}else{if(f.detachEvent){f.detachEvent("on"+d,e)}else{f["on"+d]=null}}}}(window,window.document));(function(b){var a=b.HasherEvent=function(c,e,d){this.type=c;this.oldHash=e;this.newHash=d};a.prototype.toString=function(){return'[HasherEvent type="'+this.type+'" oldHash="'+this.oldHash+'" newHash="'+this.newHash+'"]'};a.CHANGE="change";a.INIT="init";a.STOP="stop"}(window));(function(k,o){var a=k.location,n=k.history,b=k.HasherEvent,t=k.millermedeiros,e=new t.EventDispatcher(),z=t.queryUtils,g=t.event,r,m,y,c,f=navigator.userAgent,i=/MSIE/.test(f)&&(!k.opera),v=("onhashchange" in k),d=i&&!v,p=(a.protocol==="file:");function q(B){B=B||"";var A=new RegExp("^\\"+e.prependHash+"|\\"+e.appendHash+"$","g");return B.replace(A,"")}function u(){return(c)?c.contentWindow.frameHash:null}function h(B){if(c&&B!=u()){var A=c.contentWindow.document;A.open();A.write("<html><head><title>"+e.getTitle()+'</title><script type="text/javascript">var frameHash="'+B+'";<\/script></head><body>&nbsp;</body></html>');A.close()}}function l(A){A=decodeURIComponent(A);if(r!=A){var B=r;r=A;if(d){h(A)}e.dispatchEvent(new b(b.CHANGE,q(B),q(A)))}}function s(){c=o.createElement("iframe");c.src="about:blank";c.style.display="none";o.body.appendChild(c)}function x(){var A=/#(.*)$/.exec(e.getURL());return(A&&A[1])?decodeURIComponent(A[1]):""}function w(){var A=x();if(A!=r){l(A)}}function j(){var B=x(),A=q(u());if(A!=r&&A!=B){e.setHash(A)}else{if(B!=r){l(B)}}}k.Hasher=e;e.VERSION="0.9.9";e.appendHash="/";e.prependHash="/";e.separator="/";e.init=function(){if(y){return}var A=r;r=x();if(v){g.addListener(k,"hashchange",w)}else{if(d){if(!c){s();h(r)}m=setInterval(j,25)}else{m=setInterval(w,25)}}y=true;this.dispatchEvent(new b(b.INIT,q(A),q(r)))};e.stop=function(){if(!y){return}if(v){g.removeListener(k,"hashchange",w)}else{clearInterval(m);m=null}y=false;this.dispatchEvent(new b(b.STOP,q(r),q(r)))};e.isActive=function(){return y};e.getURL=function(){return a.href};e.getBaseURL=function(){return this.getURL().replace(/(\?.*)|(\#.*)/,"")};e.setHash=function(A){A=(A)?this.prependHash+A.replace(/^\#/,"")+this.appendHash:A;if(A!=r){l(A);if(i&&p){A=A.replace(/\?/,"%3F")}a.hash="#"+encodeURI(A)}};e.getHash=function(){return q(r)};e.getHashAsArray=function(){return this.getHash().split(this.separator)};e.getHashQuery=function(){return z.getQueryString(this.getHash()).substr(1)};e.getHashQueryAsObject=function(){return z.toQueryObject(this.getHashQuery())};e.getHashQueryParam=function(A){return z.getParamValue(A,this.getHash())};e.setTitle=function(A){o.title=A};e.getTitle=function(){return o.title};e.back=function(){n.back()};e.forward=function(){n.forward()};e.go=function(A){n.go(A)};e.hyphenate=function(A){A=A||"";A=A.replace(/[^0-9a-zA-Z\xC0-\xFF \-]/g,"").replace(/([a-z\xE0-\xFF])([A-Z\xC0\xDF])/g,"$1 $2").replace(/ +/g,"-");return this.removeAccents(A)};e.removeAccents=function(A){A=A||"";if(A.search(/[\xC0-\xFF]/g)>-1){A=A.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xDF]/g,"B").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF0]/g,"D").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")}return A};e.dispose=function(){e.removeAllEventListeners(true);e.stop();r=m=y=c=f=i=d=v=p=z=g=e=k.Hasher=null};e.toString=function(){return'[Hasher version="'+this.VERSION+'" hash="'+this.getHash()+'"]'}}(window,window.document));