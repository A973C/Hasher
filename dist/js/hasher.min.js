/*!
 * Hasher <http://github.com/millermedeiros/hasher>
 * @author Miller Medeiros
 * @version 1.0.0+ (2011/11/01 05:58 PM)
 * Released under the MIT License
 */
(function(a){a("hasher",["signals"],function(b){var c=(function(l){var p=25,q=l.document,d=l.location,o=l.history,v=b.Signal,g,u,n,D,f,B,s=/#(.*)$/,k=/(\?.*)|(\#.*)/,h=/^\#/,j=(!+"\v1"),z=("onhashchange" in l),e=j&&!z,r=(d.protocol==="file:");function t(F){if(!F){return""}var E=new RegExp("^\\"+g.prependHash+"|\\"+g.appendHash+"$","g");return F.replace(E,"")}function C(){var E=s.exec(g.getURL());return(E&&E[1])?decodeURIComponent(E[1]):""}function y(){return(f)?f.contentWindow.frameHash:null}function x(){f=q.createElement("iframe");f.src="about:blank";f.style.display="none";q.body.appendChild(f)}function i(){if(f&&u!==y()){var E=f.contentWindow.document;E.open();E.write("<html><head><title>"+q.title+'</title><script type="text/javascript">var frameHash="'+u+'";<\/script></head><body>&nbsp;</body></html>');E.close()}}function m(E){E=decodeURIComponent(E);if(u!==E){var F=u;u=E;if(e){i()}g.changed.dispatch(t(E),t(F))}}if(e){B=function(){var F=C(),E=y();if(E!==u&&E!==F){g.setHash(t(E))}else{if(F!==u){m(F)}}}}else{B=function(){var E=C();if(E!==u){m(E)}}}function A(G,E,F){if(G.addEventListener){G.addEventListener(E,F,false)}else{if(G.attachEvent){G.attachEvent("on"+E,F)}}}function w(G,E,F){if(G.removeEventListener){G.removeEventListener(E,F,false)}else{if(G.detachEvent){G.detachEvent("on"+E,F)}}}g={VERSION:"1.0.0+",appendHash:"",prependHash:"/",separator:"/",changed:new v(),stopped:new v(),initialized:new v(),init:function(){if(D){return}u=C();if(z){A(l,"hashchange",B)}else{if(e){if(!f){x()}i()}n=setInterval(B,p)}D=true;g.initialized.dispatch(t(u))},stop:function(){if(!D){return}if(z){w(l,"hashchange",B)}else{clearInterval(n);n=null}D=false;g.stopped.dispatch(t(u))},isActive:function(){return D},getURL:function(){return d.href},getBaseURL:function(){return g.getURL().replace(k,"")},setHash:function(E){var F=Array.prototype.slice.call(arguments);E=F.join(g.separator);E=E?g.prependHash+E.replace(h,"")+g.appendHash:E;if(E!==u){m(E);if(j&&r){E=E.replace(/\?/,"%3F")}d.hash="#"+encodeURI(E)}},getHash:function(){return t(u)},getHashAsArray:function(){return g.getHash().split(g.separator)},dispose:function(){g.stop();g.initialized.dispose();g.stopped.dispose();g.changed.dispose();f=g=l.hasher=null},toString:function(){return'[hasher version="'+g.VERSION+'" hash="'+g.getHash()+'"]'}};g.initialized.memorize=true;return g}(window));return c})}(typeof define==="function"&&define.amd?define:function(c,b,a){window[c]=a(window[b[0]])}));